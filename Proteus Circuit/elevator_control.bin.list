EMU8086 GENERATED LISTING. MACHINE CODE <- SOURCE.
 
elevator_control.bin -- emu8086 assembler version: 4.08  
 
[ 19-04-2021  --  10:17:44 ] 
 
===================================================================================================
[LINE]     LOC: MACHINE CODE                          SOURCE
===================================================================================================
 
[   1]        :                                       #make_bin#
[   2]        :                                       
[   3]        :                                       #LOAD_SEGMENT=FFFFh#
[   4]        :                                       #LOAD_OFFSET=0000h#
[   5]        :                                       
[   6]        :                                       #CS=0000h#
[   7]        :                                       #IP=0000h#
[   8]        :                                       
[   9]        :                                       #DS=0000h#
[  10]        :                                       #ES=0000h#
[  11]        :                                       
[  12]        :                                       #SS=0000h#
[  13]        :                                       #SP=FFFEh#
[  14]        :                                       
[  15]        :                                       #AX=0000h#
[  16]        :                                       #BX=0000h#
[  17]        :                                       #CX=0000h#
[  18]        :                                       #DX=0000h#
[  19]        :                                       #SI=0000h#
[  20]        :                                       #DI=0000h#
[  21]        :                                       #BP=0000h#
[  22]        :                                       
[  23]    0000: E9 FD 03                              jmp st1
[  24]    0003: 90                                    nop
[  25]    0004: 00 00 00 00 00 00 00 00 00 00 00 00   db 28 dup(0)
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[  26]        :                                       
[  27]        :                                       ; int 08h for 1 shot timer
[  28]    0020: 6C 04                                 dw os_isr
[  29]    0022: 00 00                                 dw 0
[  30]        :                                       
[  31]        :                                       ; int 09h for keyboard
[  32]    0024: 73 04                                 dw key_isr
[  33]    0026: 00 00                                 dw 0
[  34]        :                                       
[  35]        :                                       ; int 10h for Coarse Sensor 2
[  36]    0028: 52 05                                 dw cs2_isr
[  37]    002A: 00 00                                 dw 0
[  38]        :                                       
[  39]        :                                       ; int 11h for Coarse Sensor 1
[  40]    002C: 79 05                                 dw cs1_isr
[  41]    002E: 00 00                                 dw 0
[  42]        :                                       
[  43]        :                                       ; int 12h for Fine Sensor
[  44]    0030: A3 05                                 dw fs_isr
[  45]    0032: 00 00                                 dw 0
[  46]        :                                       
[  47]        :                                       ; int 13h to int 255h not used
[  48]    0034: 00 00 00 00 00 00 00 00 00 00 00 00   db 972 dup(0)
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                                                    
[  49]        :                                       
[  50]    0400: FA                                    st1: cli
[  51]        :                                       ;rom1 : 00000 - 00fff
[  52]        :                                       ;ram1 : 01000 - 01fff
[  53]        :                                       ;rom2 : ff000 - fffff
[  54]        :                                       
[  55]        :                                       ; intialize ds, es, ss to start of RAM
[  56]    0401: B8 00 01                              mov ax,0100h
[  57]    0404: 8E D8                                 mov ds,ax
[  58]    0406: 8E C0                                 mov es,ax
[  59]    0408: 8E D0                                 mov ss,ax
[  60]    040A: BC FE 1F                              mov sp,01ffeH
[  61]        :                                       
[  62]        :                                       porta equ 0b0h
[  63]        :                                       portb equ 0b2h
[  64]        :                                       portc equ 0b4h
[  65]        :                                       portcreg equ 0b6h
[  66]        :                                       
[  67]        :                                       conv25 equ 80h
[  68]        :                                       conv10 equ 82h
[  69]        :                                       pwm equ 84h
[  70]        :                                       convcreg equ 86h
[  71]        :                                       
[  72]        :                                       ostimer0 equ 90h
[  73]        :                                       ostimer1 equ 92h
[  74]        :                                       oscreg equ 96h
[  75]        :                                       
[  76]        :                                       intloc1 equ 0A0h
[  77]        :                                       intloc2 equ 0A2h
[  78]        :                                       
[  79]        :                                       bsrcreg equ 0c6h
[  80]        :                                       
[  81]        :                                       ; suppose set LIFTDIR bit (PC1 of bsr)
[  82]        :                                       ; mov al, 03h  ; 0000 001 1
[  83]        :                                       ; out bsrcreg, al
[  84]        :                                       
[  85]        :                                       ; suppose set DOORCLOSE bit (PC2 of bsr)
[  86]        :                                       ; mov al, 05h ; 0000 010 1
[  87]        :                                       ; out bsrcreg, al
[  88]        :                                       
[  89]        :                                       ; variables used
[  90]    040D: 00                                    liftMove db 0
[  91]    040E: 00                                    dest db 0
[  92]    040F: 00                                    secdest db 0
[  93]    0410: 00                                    dir db 0
[  94]    0411: 00                                    drState db 0
[  95]    0412: 00                                    current db 0
[  96]        :                                       
[  97]        :                                       ; initializing timers
[  98]        :                                       ; first timer (chip 1) mode 3; write 16 bit value 61a8h; converts 2.5MHz into 100Hz
[  99]    0413: B0 36                                 mov al, 00110110b
[ 100]    0415: E6 86                                 out convcreg, al
[ 101]    0417: B0 A8                                 mov al, 0a8h
[ 102]    0419: E6 80                                 out conv25, al
[ 103]    041B: B0 61                                 mov al, 61h
[ 104]    041D: E6 80                                 out conv25, al
[ 105]        :                                       
[ 106]        :                                       ; second timer (chip 1) mode 3; write 8 bit value 0ah; converts 100Hz to 10Hz
[ 107]    041F: B0 56                                 mov al, 01010110b
[ 108]    0421: E6 86                                 out convcreg, al
[ 109]    0423: B0 0A                                 mov al, 0ah
[ 110]    0425: E6 82                                 out conv10, al
[ 111]        :                                       
[ 112]        :                                       ; third timer (chip 1) mode 1; used for PWM
[ 113]    0427: B0 92                                 mov al, 10010010b
[ 114]    0429: E6 86                                 out convcreg, al
[ 115]    042B: B0 0A                                 mov al, 0ah ; put a value of 10 so that motor is not running at the start
[ 116]    042D: E6 84                                 out pwm, al
[ 117]        :                                       
[ 118]        :                                       ; first timer (chip 2) mode 1; write 8 bits value 01h
[ 119]    042F: B0 08                                 mov al, 00001000b
[ 120]    0431: E6 96                                 out oscreg, al
[ 121]    0433: B0 01                                 mov al, 01h
[ 122]    0435: E6 90                                 out ostimer0, al
[ 123]        :                                       
[ 124]        :                                       ; second timer (chip 2) mode 1; write 8 bits value 20
[ 125]    0437: B0 08                                 mov al, 00001000b
[ 126]    0439: E6 96                                 out oscreg, al
[ 127]    043B: B0 14                                 mov al, 20
[ 128]    043D: E6 92                                 out ostimer1, al
[ 129]        :                                       
[ 130]        :                                       ; initializing 8255
[ 131]        :                                       ; port A output from 8255; for showing current floor value in LED
[ 132]        :                                       ; port B output from 8255; for showing destination floor value in LED
[ 133]        :                                       ; port C upper input; for keyboard columns
[ 134]        :                                       ; port C lower output; for keyboard rows
[ 135]    043F: B0 88                                 mov al, 10001000b
[ 136]    0441: E6 B6                                 out portcreg, al
[ 137]    0443: B0 00                                 mov al, 00h
[ 138]    0445: E6 B2                                 out portb, al ; display zero on the LED, at the start
[ 139]    0447: E6 B0                                 out porta, al ; display zero on the LED, at the start
[ 140]    0449: E6 B4                                 out portc, al ; give zero on keyboard column at the start
[ 141]        :                                       
[ 142]        :                                       ; initialising 8255
[ 143]        :                                       ; port C output from 8255; for giving input signals to motor, lift door and one shot timer
[ 144]    044B: B0 00                                 mov al, 00000000b ; PC0 = 0 initially
[ 145]    044D: E6 C6                                 out bsrcreg, al
[ 146]    044F: B0 02                                 mov al, 00000010b ; PC1 = 0 initially
[ 147]    0451: E6 C6                                 out bsrcreg, al
[ 148]    0453: B0 04                                 mov al, 00000100b ; PC2 = 0 initially
[ 149]    0455: E6 C6                                 out bsrcreg, al
[ 150]    0457: B0 06                                 mov al, 00000110b ; PC3 = 0 initially
[ 151]        :                                       
[ 152]        :                                       
[ 153]        :                                       ; initializing 8259
[ 154]        :                                       ; IR0 = for generating 100 ms one shot timer
[ 155]        :                                       ; IR1 = for keyboard interrupt
[ 156]        :                                       ; IR2 = for Coarse Sensor 1 (CS1)
[ 157]        :                                       ; IR3 = for Coarse Sensor 2 (CS2)
[ 158]        :                                       ; IR4 = for Fine Sensor (FS)
[ 159]    0459: B0 13                                 mov al, 00010011b ; icw 1
[ 160]    045B: E6 A0                                 out intloc1, al
[ 161]    045D: B0 08                                 mov al, 00001000b ; icw 2
[ 162]    045F: E6 A2                                 out intloc2, al
[ 163]    0461: B0 01                                 mov al, 00000001b ; icw 4
[ 164]    0463: E6 A2                                 out intloc2,al
[ 165]    0465: B0 E0                                 mov al, 11100000b ; ocw 1
[ 166]    0467: E6 A2                                 out intloc2, al
[ 167]        :                                       
[ 168]    0469: FB                                    sti
[ 169]        :                                       
[ 170]    046A: EB FE                                 infiloop: jmp infiloop
[ 171]        :                                       
[ 172]        :                                       ;-------------------------------------------------------------------------------------------
[ 173]        :                                       
[ 174]        :                                       ;all isrs used in the program
[ 175]        :                                       
[ 176]        :                                       ; ISR for one shot timer
[ 177]    046C:                                       os_isr:
[ 178]    046C: B0 60                                 mov al, 01100000b ; ocw 2 specific EOI for IR0
[ 179]    046E: E6 A0                                 out intloc1, al
[ 180]        :                                       
[ 181]    0470: B1 01                                 mov CL, 01h
[ 182]    0472: CF                                    iret
[ 183]        :                                       
[ 184]        :                                       ; ISR for keyboard
[ 185]    0473:                                       key_isr:
[ 186]    0473: B0 61                                 mov al, 01100001b ; ocw 2 specific EOI for IR1
[ 187]    0475: E6 A0                                 out intloc1, al
[ 188]        :                                       
[ 189]        :                                       ; check for key press
[ 190]    0477: B0 00                                 mov al, 00h
[ 191]    0479: E6 B4                                 out portc, al
[ 192]        :                                       
[ 193]    047B: E4 B4                                 x1: in al, portc
[ 194]    047D: 24 F0                                 and al, 0f0h
[ 195]    047F: 3C F0                                 cmp al, 0f0h
[ 196]    0481: 74 F8                                 jz x1
[ 197]        :                                       
[ 198]        :                                       ; check for key press in column 1
[ 199]    0483: B0 0E                                 mov al, 0eh
[ 200]    0485: 8A D8                                 mov bl, al
[ 201]        :                                       
[ 202]    0487: E6 B4                                 out portc, al
[ 203]    0489: E4 B4                                 in al, portc
[ 204]        :                                       
[ 205]    048B: 24 F0                                 and al, 0f0h
[ 206]    048D: 3C F0                                 cmp al, 0f0h
[ 207]    048F: 75 2A                                 jnz check_key
[ 208]        :                                       
[ 209]        :                                       ; check for key press in column 2
[ 210]    0491: B0 0D                                 mov al, 0dh
[ 211]    0493: 8A D8                                 mov bl, al
[ 212]        :                                       
[ 213]    0495: E6 B4                                 out portc, al
[ 214]    0497: E4 B4                                 in al, portc
[ 215]        :                                       
[ 216]    0499: 24 F0                                 and al, 0f0h
[ 217]    049B: 3C F0                                 cmp al, 0f0h
[ 218]    049D: 75 1C                                 jnz check_key
[ 219]        :                                       
[ 220]        :                                       ; check for key press in column 3
[ 221]    049F: B0 0B                                 mov al, 0bh
[ 222]    04A1: 8A D8                                 mov bl, al
[ 223]        :                                       
[ 224]    04A3: E6 B4                                 out portc, al
[ 225]    04A5: E4 B4                                 in al, portc
[ 226]        :                                       
[ 227]    04A7: 24 F0                                 and al, 0f0h
[ 228]    04A9: 3C F0                                 cmp al, 0f0h
[ 229]    04AB: 75 0E                                 jnz check_key
[ 230]        :                                       
[ 231]        :                                       ; check for key press in column 4
[ 232]    04AD: B0 0B                                 mov al, 0bh
[ 233]    04AF: 8A D8                                 mov bl, al
[ 234]        :                                       
[ 235]    04B1: E6 B4                                 out portc, al
[ 236]    04B3: E4 B4                                 in al, portc
[ 237]        :                                       
[ 238]    04B5: 24 F0                                 and al, 0f0h
[ 239]    04B7: 3C F0                                 cmp al, 0f0h
[ 240]    04B9: 75 00                                 jnz check_key
[ 241]        :                                       
[ 242]        :                                       ; find out which key was pressed from hex keypad
[ 243]        :                                       ; key00 => EEh == CLOSE DOOR
[ 244]        :                                       ; key04 => DEh == UP0
[ 245]        :                                       ; key05 => DDh == DOWN1
[ 246]        :                                       ; key06 => DBh == UP1
[ 247]        :                                       ; key07 => D7h == DOWN2
[ 248]        :                                       ; key08 => BEh == UP2
[ 249]        :                                       ; key09 => BDh == DOWN3
[ 250]        :                                       ; key10 => BBh == LIFT0
[ 251]        :                                       ; key11 => B7h == LIFT1
[ 252]        :                                       ; key12 => 7Eh == LIFT2
[ 253]        :                                       ; key13 => 7Dh == LIFT3
[ 254]        :                                       
[ 255]    04BB:                                       check_key:
[ 256]    04BB: 0A C3                                 or al, bl ; which key is pressed
[ 257]    04BD: 3C EE                                 cmp al, 0eeh
[ 258]    04BF: 75 09                                 jnz x5
[ 259]        :                                       
[ 260]    04C1: B0 00                                 mov al, 00
[ 261]    04C3: E6 B4                                 out portc, al
[ 262]        :                                       
[ 263]    04C5: E8 1F 09                              call drClose
[ 264]    04C8: EB F1                                 jmp check_key
[ 265]        :                                       
[ 266]    04CA: 3C DE                                 x5: cmp al, 0deh
[ 267]    04CC: 75 09                                 jnz x6
[ 268]        :                                       
[ 269]    04CE: B0 00                                 mov al, 00
[ 270]    04D0: E6 B4                                 out portc, al
[ 271]        :                                       
[ 272]    04D2: E8 48 01                              call up0
[ 273]    04D5: EB E4                                 jmp check_key
[ 274]        :                                       
[ 275]    04D7: 3C DD                                 x6: cmp al, 0ddh
[ 276]    04D9: 75 09                                 jnz x7
[ 277]        :                                       
[ 278]    04DB: B0 00                                 mov al, 00
[ 279]    04DD: E6 B4                                 out portc, al
[ 280]        :                                       
[ 281]    04DF: E8 92 01                              call down1
[ 282]    04E2: EB D7                                 jmp check_key
[ 283]        :                                       
[ 284]    04E4: 3C DB                                 x7: cmp al, 0dbh
[ 285]    04E6: 75 09                                 jnz x8
[ 286]        :                                       
[ 287]    04E8: B0 00                                 mov al, 00
[ 288]    04EA: E6 B4                                 out portc, al
[ 289]        :                                       
[ 290]    04EC: E8 8C 03                              call up1
[ 291]    04EF: EB CA                                 jmp check_key
[ 292]        :                                       
[ 293]    04F1: 3C D7                                 x8: cmp al, 0d7h
[ 294]    04F3: 75 09                                 jnz x9
[ 295]        :                                       
[ 296]    04F5: B0 00                                 mov al, 00
[ 297]    04F7: E6 B4                                 out portc, al
[ 298]        :                                       
[ 299]    04F9: E8 81 04                              call down2
[ 300]    04FC: EB BD                                 jmp check_key
[ 301]        :                                       
[ 302]    04FE: 3C BE                                 x9:cmp al, 0beh
[ 303]    0500: 75 09                                 jnz x10
[ 304]        :                                       
[ 305]    0502: B0 00                                 mov al, 00
[ 306]    0504: E6 B4                                 out portc, al
[ 307]        :                                       
[ 308]    0506: E8 8D 02                              call up2
[ 309]    0509: EB B0                                 jmp check_key
[ 310]        :                                       
[ 311]    050B: 3C BD                                 x10:cmp al, 0bdh
[ 312]    050D: 75 09                                 jnz x11
[ 313]        :                                       
[ 314]    050F: B0 00                                 mov al, 00
[ 315]    0511: E6 B4                                 out portc, al
[ 316]        :                                       
[ 317]    0513: E8 10 04                              call down3
[ 318]    0516: EB A3                                 jmp check_key
[ 319]        :                                       
[ 320]    0518: 3C BB                                 x11:cmp al, 0bbh
[ 321]    051A: 75 09                                 jnz x12
[ 322]        :                                       
[ 323]    051C: B0 00                                 mov al, 00
[ 324]    051E: E6 B4                                 out portc, al
[ 325]        :                                       
[ 326]    0520: E8 17 05                              call lift0
[ 327]    0523: EB 96                                 jmp check_key
[ 328]        :                                       
[ 329]    0525: 3C B7                                 x12:cmp al, 0b7h
[ 330]    0527: 75 09                                 jnz x13
[ 331]        :                                       
[ 332]    0529: B0 00                                 mov al, 00
[ 333]    052B: E6 B4                                 out portc, al
[ 334]        :                                       
[ 335]    052D: E8 DE 05                              call lift1
[ 336]    0530: EB 89                                 jmp check_key
[ 337]        :                                       
[ 338]    0532: 3C 7E                                 x13:cmp al, 07eh
[ 339]    0534: 75 0A                                 jnz x14
[ 340]        :                                       
[ 341]    0536: B0 00                                 mov al, 00
[ 342]    0538: E6 B4                                 out portc, al
[ 343]        :                                       
[ 344]    053A: E8 D3 06                              call lift2
[ 345]    053D: E9 7B FF                              jmp check_key
[ 346]        :                                       
[ 347]    0540: 3C 7D                                 x14:cmp al, 07dh
[ 348]    0542: 74 03 E9 74 FF                        jnz check_key
[ 349]        :                                       
[ 350]    0547: B0 00                                 mov al, 00
[ 351]    0549: E6 B4                                 out portc, al
[ 352]        :                                       
[ 353]    054B: E8 C5 07                              call lift3
[ 354]    054E: E9 6A FF                              jmp check_key
[ 355]        :                                       
[ 356]    0551: CF                                    iret
[ 357]        :                                       
[ 358]        :                                       
[ 359]        :                                       ; ISR for coarse sensor 2
[ 360]    0552:                                       cs2_isr:
[ 361]    0552: 50                                    push ax
[ 362]    0553: 53                                    push bx
[ 363]        :                                       
[ 364]    0554: B0 63                                 mov al, 01100011b ; ocw 2 specific EOI for IR3
[ 365]    0556: E6 A0                                 out intloc1, al
[ 366]        :                                       
[ 367]    0558: A0 10 04                              mov al, dir
[ 368]    055B: 8A 26 12 04                           mov ah, current
[ 369]    055F: 8A 1E 0E 04                           mov bl, dest
[ 370]        :                                       
[ 371]    0563: 3C 00                                 cmp al, 00h
[ 372]    0565: 75 06                                 jnz dir_down
[ 373]        :                                       
[ 374]    0567: E8 D8 08                              call accel50
[ 375]        :                                       
[ 376]    056A: 5B                                    pop bx
[ 377]    056B: 58                                    pop ax
[ 378]    056C: CF                                    iret
[ 379]        :                                       
[ 380]        :                                       
[ 381]    056D:                                       dir_down:
[ 382]    056D: FE CC                                 dec ah
[ 383]    056F: 3A E3                                 cmp ah, bl
[ 384]    0571: 75 FA                                 jnz dir_down
[ 385]        :                                       
[ 386]    0573: E8 D3 08                              call decel20
[ 387]        :                                       
[ 388]    0576: 5B                                    pop bx
[ 389]    0577: 58                                    pop ax
[ 390]    0578: CF                                    iret
[ 391]        :                                       
[ 392]        :                                       ; SR for coarse sensor 1
[ 393]    0579:                                       cs1_isr:
[ 394]    0579: 50                                    push ax
[ 395]    057A: 53                                    push bx
[ 396]        :                                       
[ 397]    057B: B0 62                                 mov al, 01100010b ; ocw 2 specific EOI for IR2
[ 398]    057D: E6 A0                                 out intloc1, al
[ 399]        :                                       
[ 400]    057F: A0 10 04                              mov al, dir
[ 401]    0582: 8A 26 12 04                           mov ah, current
[ 402]    0586: 8A 1E 0E 04                           mov bl, dest
[ 403]        :                                       
[ 404]    058A: 80 3E 10 04 01                        cmp dir, 01
[ 405]    058F: 75 06                                 jnz dir_up
[ 406]        :                                       
[ 407]    0591: E8 AE 08                              call accel50
[ 408]    0594: 5B                                    pop bx
[ 409]    0595: 58                                    pop ax
[ 410]    0596: CF                                    iret
[ 411]        :                                       
[ 412]        :                                       
[ 413]    0597:                                       dir_up:
[ 414]    0597: FE C4                                 inc ah
[ 415]    0599: 3A E3                                 cmp ah, bl
[ 416]    059B: 75 FA                                 jnz dir_up
[ 417]        :                                       
[ 418]    059D: E8 A9 08                              call decel20
[ 419]        :                                       
[ 420]    05A0: 5B                                    pop bx
[ 421]    05A1: 58                                    pop ax
[ 422]    05A2: CF                                    iret
[ 423]        :                                       
[ 424]        :                                       ; SR for fine sensor
[ 425]    05A3:                                       fs_isr:
[ 426]    05A3: 50                                    push ax
[ 427]    05A4: 53                                    push bx
[ 428]        :                                       
[ 429]    05A5: B0 64                                 mov al, 01100100b ; ocw 2 specific EOI for IR4
[ 430]    05A7: E6 A0                                 out intloc1, al
[ 431]        :                                       
[ 432]    05A9: A0 0D 04                              mov al, liftMove
[ 433]    05AC: 8A 26 12 04                           mov ah, current
[ 434]    05B0: 8A 1E 0E 04                           mov bl, dest
[ 435]    05B4: 8A 3E 10 04                           mov bh, dir
[ 436]        :                                       
[ 437]    05B8: 3C 01                                 cmp al, 01h
[ 438]    05BA: 75 47                                 jnz f2
[ 439]        :                                       
[ 440]    05BC: 80 FF 00                              cmp bh, 00h
[ 441]    05BF: 75 21                                 jnz f4
[ 442]        :                                       
[ 443]    05C1: FE CC                                 dec ah
[ 444]    05C3: 88 26 12 04                           mov current, ah
[ 445]    05C7: 3A E3                                 cmp ah, bl
[ 446]    05C9: 75 3B                                 jnz f1
[ 447]        :                                       
[ 448]    05CB: E8 7B 08                              call decel20
[ 449]    05CE: E8 22 08                              call ledDisp
[ 450]        :                                       
[ 451]    05D1: C6 06 11 04 00                        mov drState, 00h
[ 452]    05D6: B0 04                                 mov AL, 04h
[ 453]    05D8: E6 C6                                 out bsrcreg, AL
[ 454]        :                                       
[ 455]    05DA: C6 06 0D 04 00                        mov liftMove, 00h
[ 456]        :                                       
[ 457]    05DF: 5B                                    pop bx
[ 458]    05E0: 58                                    pop ax
[ 459]    05E1: CF                                    iret
[ 460]        :                                       
[ 461]        :                                       
[ 462]    05E2:                                       f4:
[ 463]    05E2: FE C4                                 inc ah
[ 464]    05E4: 88 26 12 04                           mov current, ah
[ 465]    05E8: 3A E3                                 cmp ah, bl
[ 466]    05EA: 75 1A                                 jnz f1
[ 467]        :                                       
[ 468]    05EC: E8 5A 08                              call decel20
[ 469]    05EF: E8 01 08                              call ledDisp
[ 470]        :                                       
[ 471]    05F2: C6 06 11 04 00                        mov drState, 00h
[ 472]    05F7: B0 04                                 mov AL, 04h
[ 473]    05F9: E6 C6                                 out bsrcreg, AL
[ 474]        :                                       
[ 475]    05FB: C6 06 0D 04 00                        mov liftMove, 00h
[ 476]        :                                       
[ 477]    0600: 5B                                    pop bx
[ 478]    0601: 58                                    pop ax
[ 479]    0602: CF                                    iret
[ 480]        :                                       
[ 481]        :                                       
[ 482]    0603:                                       f2:
[ 483]    0603: 5B                                    pop bx
[ 484]    0604: 58                                    pop ax
[ 485]    0605: CF                                    iret
[ 486]        :                                       
[ 487]        :                                       
[ 488]    0606:                                       f1:
[ 489]    0606: 80 FF 00                              cmp bh, 00h
[ 490]    0609: 75 09                                 jnz f3
[ 491]        :                                       
[ 492]    060B: FE CC                                 dec ah
[ 493]    060D: 88 26 12 04                           mov current, ah
[ 494]        :                                       
[ 495]    0611: 5B                                    pop bx
[ 496]    0612: 58                                    pop ax
[ 497]    0613: CF                                    iret
[ 498]        :                                       
[ 499]        :                                       
[ 500]    0614:                                       f3:
[ 501]    0614: FE C4                                 inc ah
[ 502]    0616: 88 26 12 04                           mov current, ah
[ 503]        :                                       
[ 504]    061A: 5B                                    pop bx
[ 505]    061B: 58                                    pop ax
[ 506]    061C: CF                                    iret
[ 507]        :                                       
[ 508]        :                                       
[ 509]        :                                       ; -------------------------------------------------------------------------------------
[ 510]        :                                       
[ 511]        :                                       ; all subroutines used in ISR
[ 512]    061D:                                       up0 proc near
[ 513]    061D: 50                                    push ax
[ 514]    061E: 53                                    push bx
[ 515]    061F: 51                                    push cx
[ 516]        :                                       
[ 517]    0620: A0 12 04                              mov al, current
[ 518]    0623: 8A 26 0D 04                           mov ah, liftMove
[ 519]    0627: 8A 1E 11 04                           mov bl, drState
[ 520]        :                                       
[ 521]    062B: 3C 00                                 cmp al,00
[ 522]    062D: 75 12                                 jnz y2
[ 523]        :                                       
[ 524]    062F: 80 FC 00                              cmp ah,00
[ 525]    0632: 75 0D                                 jnz y2
[ 526]        :                                       
[ 527]        :                                       
[ 528]    0634:                                       y1:
[ 529]    0634: C6 06 11 04 00                        mov drState, 00h
[ 530]    0639: B0 04                                 mov AL, 04h
[ 531]    063B: E6 C6                                 out bsrcreg, AL
[ 532]        :                                       
[ 533]    063D: 59                                    pop cx
[ 534]    063E: 5B                                    pop bx
[ 535]    063F: 58                                    pop ax
[ 536]    0640: C3                                    ret
[ 537]        :                                       
[ 538]        :                                       
[ 539]    0641:                                       y2:
[ 540]    0641: 80 FC 00                              cmp ah, 00
[ 541]    0644: 75 FB                                 jnz y2
[ 542]        :                                       
[ 543]    0646: 3C 00                                 cmp al, 00
[ 544]    0648: 74 EA                                 jz y1
[ 545]        :                                       
[ 546]    064A: C6 06 0E 04 00                        mov dest, 00
[ 547]    064F: C6 06 10 04 00                        mov dir, 00
[ 548]    0654: B0 02                                 mov AL, 02h
[ 549]    0656: E6 C6                                 out bsrcreg,al
[ 550]        :                                       
[ 551]    0658: C6 06 11 04 01                        mov drState, 01h
[ 552]    065D: B0 05                                 mov AL, 05h
[ 553]    065F: E6 C6                                 out bsrcreg, AL
[ 554]        :                                       
[ 555]    0661: B1 00                                 mov cl, 0
[ 556]    0663: 80 F9 01                              q1: cmp cl, 1
[ 557]    0666: 75 FB                                 jne q1
[ 558]        :                                       
[ 559]    0668: C6 06 0D 04 01                        mov liftMove, 01
[ 560]    066D: E8 A3 07                              call liftstar
[ 561]        :                                       
[ 562]    0670: 59                                    pop cx
[ 563]    0671: 5B                                    pop bx
[ 564]    0672: 58                                    pop ax
[ 565]    0673: C3                                    ret
[ 566]        :                                       up0 endp
[ 567]        :                                       
[ 568]        :                                       
[ 569]    0674:                                       down1 proc near
[ 570]    0674: 50                                    push ax
[ 571]    0675: 53                                    push bx
[ 572]    0676: 51                                    push cx
[ 573]        :                                       
[ 574]    0677: A0 12 04                              mov al, current
[ 575]    067A: 8A 26 0D 04                           mov ah, liftMove
[ 576]    067E: 8A 1E 11 04                           mov bl, drState
[ 577]    0682: 8A 3E 10 04                           mov bh, dir
[ 578]        :                                       
[ 579]    0686: 3C 01                                 cmp al, 01
[ 580]    0688: 74 03 E9 83 00                        jnz y3
[ 581]        :                                       
[ 582]    068D: 80 FC 01                              cmp ah, 01
[ 583]    0690: 75 71                                 jnz y4
[ 584]        :                                       
[ 585]        :                                       
[ 586]    0692: 80 FC 01                              y5: cmp ah, 01
[ 587]    0695: 74 FB                                 jz y5
[ 588]        :                                       
[ 589]        :                                       
[ 590]    0697:                                       y11:
[ 591]    0697: C6 06 0E 04 01                        mov dest, 01
[ 592]    069C: C6 06 10 04 00                        mov dir, 00
[ 593]    06A1: B0 02                                 mov al, 02h
[ 594]    06A3: E6 C6                                 out bsrcreg, al
[ 595]        :                                       
[ 596]    06A5: C6 06 11 04 01                        mov drState, 01h
[ 597]    06AA: B0 05                                 mov AL, 05h
[ 598]    06AC: E6 C6                                 out bsrcreg, AL
[ 599]        :                                       
[ 600]    06AE: B1 00                                 mov cl, 0
[ 601]    06B0: 80 F9 01                              q8: cmp cl, 1
[ 602]    06B3: 75 FB                                 jne q8
[ 603]        :                                       
[ 604]    06B5: C6 06 0D 04 01                        mov liftMove, 01
[ 605]    06BA: E8 56 07                              call liftstar
[ 606]        :                                       
[ 607]    06BD: 80 FC 00                              cmp ah, 00
[ 608]    06C0: 75 1C                                 jnz y12
[ 609]        :                                       
[ 610]    06C2: C6 06 10 04 01                        mov dir, 01
[ 611]    06C7: B0 03                                 mov al,03H
[ 612]    06C9: E6 C6                                 out bsrcreg,al
[ 613]        :                                       
[ 614]    06CB: B1 00                                 mov cl, 0
[ 615]    06CD: 80 F9 01                              q2: cmp cl, 1
[ 616]    06D0: 75 FB                                 jne q2
[ 617]        :                                       
[ 618]    06D2: C6 06 0D 04 01                        mov liftMove, 1
[ 619]    06D7: E8 39 07                              call liftstar
[ 620]        :                                       
[ 621]    06DA: 59                                    pop cx
[ 622]    06DB: 5B                                    pop bx
[ 623]    06DC: 58                                    pop ax
[ 624]    06DD: C3                                    ret
[ 625]        :                                       
[ 626]        :                                       
[ 627]    06DE:                                       y12:
[ 628]    06DE: C6 06 11 04 00                        mov drState, 00h
[ 629]    06E3: B0 04                                 mov AL, 04h
[ 630]    06E5: E6 C6                                 out bsrcreg, AL
[ 631]        :                                       
[ 632]    06E7: C6 06 10 04 00                        mov dir, 00
[ 633]    06EC: B0 02                                 mov AL, 02h
[ 634]    06EE: E6 C6                                 out bsrcreg,al
[ 635]        :                                       
[ 636]    06F0: B1 00                                 mov cl, 0
[ 637]    06F2: 80 F9 01                              q3: cmp cl, 1
[ 638]    06F5: 75 FB                                 jne q3
[ 639]        :                                       
[ 640]    06F7: C6 06 0D 04 01                        mov liftMove, 01
[ 641]    06FC: E8 14 07                              call liftstar
[ 642]        :                                       
[ 643]    06FF: 59                                    pop cx
[ 644]    0700: 5B                                    pop bx
[ 645]    0701: 58                                    pop ax
[ 646]    0702: C3                                    ret
[ 647]        :                                       
[ 648]        :                                       
[ 649]    0703:                                       y4:
[ 650]    0703: C6 06 11 04 00                        mov drState, 00h
[ 651]    0708: B0 04                                 mov AL, 04h
[ 652]    070A: E6 C6                                 out bsrcreg, AL
[ 653]        :                                       
[ 654]    070C: 59                                    pop cx
[ 655]    070D: 5B                                    pop bx
[ 656]    070E: 58                                    pop ax
[ 657]    070F: C3                                    ret
[ 658]        :                                       
[ 659]    0710:                                       y3:
[ 660]    0710: 80 FC 01                              cmp ah, 01
[ 661]    0713: 75 55                                 jnz y6
[ 662]        :                                       
[ 663]    0715: 80 FF 00                              cmp bh, 0
[ 664]    0718: 75 49                                 jnz y7
[ 665]        :                                       
[ 666]    071A: 3C 02                                 cmp al, 2
[ 667]    071C: 75 0D                                 jnz y8
[ 668]        :                                       
[ 669]        :                                       
[ 670]    071E:                                       y9:
[ 671]    071E: 8A 0E 0E 04                           mov cl, dest
[ 672]    0722: 88 0E 0F 04                           mov secdest, cl
[ 673]    0726: C6 06 0E 04 01                        mov dest,1
[ 674]        :                                       
[ 675]        :                                       
[ 676]    072B:                                       y8:
[ 677]    072B: 8A 0E 0E 04                           mov cl, dest
[ 678]    072F: 80 F9 02                              cmp cl, 02
[ 679]    0732: 75 EA                                 jnz y9
[ 680]        :                                       
[ 681]        :                                       
[ 682]    0734:                                       y10:
[ 683]    0734: 80 FC 00                              cmp ah, 00
[ 684]    0737: 75 FB                                 jnz y10
[ 685]        :                                       
[ 686]    0739: C6 06 0E 04 01                        mov dest, 01
[ 687]    073E: C6 06 11 04 01                        mov drState, 01h
[ 688]    0743: B0 05                                 mov AL, 05h
[ 689]    0745: E6 C6                                 out bsrcreg, AL
[ 690]        :                                       
[ 691]    0747: C6 06 10 04 00                        mov dir, 00
[ 692]    074C: B0 02                                 mov AL, 02h
[ 693]    074E: E6 C6                                 out bsrcreg,al
[ 694]        :                                       
[ 695]    0750: B1 00                                 mov cl, 0
[ 696]    0752: 80 F9 01                              q4: cmp cl, 1
[ 697]    0755: 75 FB                                 jne q4
[ 698]        :                                       
[ 699]    0757: C6 06 0D 04 01                        mov liftMove, 01
[ 700]    075C: E8 B4 06                              call liftstar
[ 701]        :                                       
[ 702]    075F: 59                                    pop cx
[ 703]    0760: 5B                                    pop bx
[ 704]    0761: 58                                    pop ax
[ 705]    0762: C3                                    ret
[ 706]        :                                       
[ 707]        :                                       
[ 708]    0763:                                       y7:
[ 709]    0763: 80 FC 00                              cmp ah, 00
[ 710]    0766: 75 FB                                 jnz y7
[ 711]    0768: EB 00                                 jmp y6
[ 712]        :                                       
[ 713]        :                                       
[ 714]    076A:                                       y6:
[ 715]    076A: 3C 01                                 cmp al, 01
[ 716]    076C: 74 03 E9 26 FF                        jnz y11
[ 717]        :                                       
[ 718]    0771: C6 06 10 04 00                        mov dir, 00
[ 719]    0776: B0 02                                 mov al, 02h
[ 720]    0778: E6 C6                                 out bsrcreg, al
[ 721]        :                                       
[ 722]    077A: C6 06 11 04 00                        mov drState, 00h
[ 723]    077F: B0 04                                 mov AL, 04h
[ 724]    0781: E6 C6                                 out bsrcreg, AL
[ 725]        :                                       
[ 726]    0783: B1 00                                 mov cl, 0
[ 727]    0785: 80 F9 01                              q9: cmp cl, 1
[ 728]    0788: 75 FB                                 jne q9
[ 729]        :                                       
[ 730]    078A: C6 06 0D 04 01                        mov liftMove, 01
[ 731]    078F: E8 81 06                              call liftstar
[ 732]        :                                       
[ 733]    0792: 59                                    pop cx
[ 734]    0793: 5B                                    pop bx
[ 735]    0794: 58                                    pop ax
[ 736]    0795: C3                                    ret
[ 737]        :                                       down1 endp
[ 738]        :                                       
[ 739]        :                                       
[ 740]    0796:                                       up2 proc near
[ 741]    0796: 50                                    push ax
[ 742]    0797: 53                                    push bx
[ 743]    0798: 51                                    push cx
[ 744]        :                                       
[ 745]    0799: A0 12 04                              mov al, current
[ 746]    079C: 8A 26 0D 04                           mov ah, liftMove
[ 747]    07A0: 8A 1E 11 04                           mov bl, drState
[ 748]    07A4: 8A 3E 10 04                           mov bh, dir
[ 749]        :                                       
[ 750]    07A8: 3C 02                                 cmp al, 02
[ 751]    07AA: 75 61                                 jnz up2y3
[ 752]        :                                       
[ 753]    07AC: 80 FC 01                              cmp ah, 01
[ 754]    07AF: 75 4F                                 jnz up2y4
[ 755]        :                                       
[ 756]        :                                       
[ 757]    07B1: 80 FC 01                              up2y5: cmp ah, 01
[ 758]    07B4: 74 FB                                 jz up2y5
[ 759]        :                                       
[ 760]        :                                       
[ 761]    07B6:                                       up2y11:
[ 762]    07B6: C6 06 0E 04 02                        mov dest, 02
[ 763]    07BB: C6 06 11 04 01                        mov drState, 01h
[ 764]    07C0: B0 05                                 mov AL, 05h
[ 765]    07C2: E6 C6                                 out bsrcreg, AL
[ 766]        :                                       
[ 767]    07C4: 3C 03                                 cmp al, 03
[ 768]    07C6: 75 1C                                 jnz up2y12
[ 769]        :                                       
[ 770]    07C8: C6 06 10 04 00                        mov dir, 00
[ 771]    07CD: B0 02                                 mov AL, 02h
[ 772]    07CF: E6 C6                                 out bsrcreg,al
[ 773]        :                                       
[ 774]    07D1: B1 00                                 mov cl, 0
[ 775]    07D3: 80 F9 01                              q5: cmp cl, 1
[ 776]    07D6: 75 FB                                 jne q5
[ 777]        :                                       
[ 778]    07D8: C6 06 0D 04 01                        mov liftMove, 01
[ 779]    07DD: E8 33 06                              call liftstar
[ 780]        :                                       
[ 781]    07E0: 59                                    pop cx
[ 782]    07E1: 5B                                    pop bx
[ 783]    07E2: 58                                    pop ax
[ 784]    07E3: C3                                    ret
[ 785]        :                                       
[ 786]        :                                       
[ 787]    07E4:                                       up2y12:
[ 788]    07E4: C6 06 10 04 01                        mov dir, 01
[ 789]    07E9: B0 03                                 mov al,03H
[ 790]    07EB: E6 C6                                 out bsrcreg,al
[ 791]        :                                       
[ 792]    07ED: B1 00                                 mov cl, 0
[ 793]    07EF: 80 F9 01                              q6: cmp cl, 1
[ 794]    07F2: 75 FB                                 jne q6
[ 795]        :                                       
[ 796]    07F4: C6 06 0D 04 01                        mov liftMove, 01
[ 797]    07F9: E8 17 06                              call liftstar
[ 798]        :                                       
[ 799]    07FC: 59                                    pop cx
[ 800]    07FD: 5B                                    pop bx
[ 801]    07FE: 58                                    pop ax
[ 802]    07FF: C3                                    ret
[ 803]        :                                       
[ 804]        :                                       
[ 805]    0800:                                       up2y4:
[ 806]    0800: C6 06 11 04 00                        mov drState, 00h
[ 807]    0805: B0 04                                 mov AL, 04h
[ 808]    0807: E6 C6                                 out bsrcreg, AL
[ 809]        :                                       
[ 810]    0809: 59                                    pop cx
[ 811]    080A: 5B                                    pop bx
[ 812]    080B: 58                                    pop ax
[ 813]    080C: C3                                    ret
[ 814]        :                                       
[ 815]        :                                       
[ 816]    080D:                                       up2y3:
[ 817]    080D: 80 FC 01                              cmp ah, 01
[ 818]    0810: 75 55                                 jnz up2y6
[ 819]        :                                       
[ 820]    0812: 80 FF 01                              cmp bh, 1
[ 821]    0815: 75 49                                 jnz up2y7
[ 822]        :                                       
[ 823]    0817: 3C 01                                 cmp al, 1
[ 824]    0819: 75 0D                                 jnz up2y8
[ 825]        :                                       
[ 826]        :                                       
[ 827]    081B:                                       up2y9:
[ 828]    081B: 8A 0E 0E 04                           mov cl, dest
[ 829]    081F: 88 0E 0F 04                           mov secdest, cl
[ 830]    0823: C6 06 0E 04 02                        mov dest, 2
[ 831]        :                                       
[ 832]        :                                       
[ 833]    0828:                                       up2y8:
[ 834]    0828: 8A 0E 0E 04                           mov cl, dest
[ 835]    082C: 80 F9 01                              cmp cl, 01
[ 836]    082F: 75 EA                                 jnz up2y9
[ 837]        :                                       
[ 838]        :                                       
[ 839]    0831:                                       up2y10:
[ 840]    0831: 80 FC 01                              cmp ah, 01
[ 841]    0834: 74 FB                                 jz up2y10
[ 842]        :                                       
[ 843]    0836: C6 06 0E 04 02                        mov dest, 02
[ 844]    083B: C6 06 11 04 01                        mov drState, 01h
[ 845]    0840: B0 05                                 mov AL, 05h
[ 846]    0842: E6 C6                                 out bsrcreg, AL
[ 847]        :                                       
[ 848]    0844: C6 06 10 04 01                        mov dir, 01
[ 849]    0849: B0 03                                 mov al,03H
[ 850]    084B: E6 C6                                 out bsrcreg,al
[ 851]        :                                       
[ 852]    084D: B1 00                                 mov cl, 0
[ 853]    084F: 80 F9 01                              q7: cmp cl, 1
[ 854]    0852: 75 FB                                 jne q7
[ 855]        :                                       
[ 856]    0854: C6 06 0D 04 01                        mov liftMove, 01
[ 857]    0859: E8 B7 05                              call liftstar
[ 858]        :                                       
[ 859]    085C: 59                                    pop cx
[ 860]    085D: 5B                                    pop bx
[ 861]    085E: 58                                    pop ax
[ 862]    085F: C3                                    ret
[ 863]        :                                       
[ 864]        :                                       
[ 865]    0860:                                       up2y7:
[ 866]    0860: 80 FC 01                              cmp ah, 01
[ 867]    0863: 74 FB                                 jz up2y7
[ 868]        :                                       
[ 869]    0865: EB 00                                 jmp up2y6
[ 870]        :                                       
[ 871]        :                                       
[ 872]    0867:                                       up2y6:
[ 873]    0867: 3C 02                                 cmp al, 02
[ 874]    0869: 74 03 E9 48 FF                        jnz up2y11
[ 875]        :                                       
[ 876]    086E: C6 06 11 04 00                        mov drState, 00h
[ 877]    0873: B0 04                                 mov AL, 04h
[ 878]    0875: E6 C6                                 out bsrcreg, AL
[ 879]        :                                       
[ 880]    0877: 59                                    pop cx
[ 881]    0878: 5B                                    pop bx
[ 882]    0879: 58                                    pop ax
[ 883]    087A: C3                                    ret
[ 884]        :                                       up2 endp
[ 885]        :                                       
[ 886]        :                                       
[ 887]    087B:                                       up1 proc near
[ 888]    087B: 50                                    push ax
[ 889]    087C: 53                                    push bx
[ 890]    087D: 51                                    push cx
[ 891]        :                                       
[ 892]    087E: A0 12 04                              mov al, current
[ 893]    0881: 8A 26 0D 04                           mov ah, liftMove
[ 894]    0885: 8A 1E 11 04                           mov bl, drState
[ 895]    0889: 8A 3E 10 04                           mov bh, dir
[ 896]        :                                       
[ 897]    088D: 3C 01                                 cmp al, 01
[ 898]    088F: 75 62                                 jnz up1y3
[ 899]        :                                       
[ 900]    0891: 80 FC 01                              cmp ah, 01
[ 901]    0894: 75 50                                 jnz up1y4
[ 902]        :                                       
[ 903]        :                                       
[ 904]    0896: 80 FC 01                              up1y5: cmp ah, 01
[ 905]    0899: 74 FB                                 jz up1y5
[ 906]        :                                       
[ 907]        :                                       
[ 908]    089B:                                       up1y11:
[ 909]    089B: C6 06 0E 04 01                        mov dest, 01
[ 910]    08A0: C6 06 11 04 01                        mov drState, 01h
[ 911]    08A5: B0 05                                 mov AL, 05h
[ 912]    08A7: E6 C6                                 out bsrcreg, AL
[ 913]        :                                       
[ 914]    08A9: 80 FC 00                              cmp ah, 00
[ 915]    08AC: 75 1C                                 jnz up1y12
[ 916]        :                                       
[ 917]    08AE: C6 06 10 04 01                        mov dir, 01
[ 918]    08B3: B0 03                                 mov al,03H
[ 919]    08B5: E6 C6                                 out bsrcreg,al
[ 920]        :                                       
[ 921]    08B7: B1 00                                 mov cl, 0
[ 922]    08B9: 80 F9 01                              q10:cmp cl, 1
[ 923]    08BC: 75 FB                                 jne q10
[ 924]        :                                       
[ 925]    08BE: C6 06 0D 04 01                        mov liftMove, 01
[ 926]    08C3: E8 4D 05                              call liftstar
[ 927]        :                                       
[ 928]    08C6: 59                                    pop cx
[ 929]    08C7: 5B                                    pop bx
[ 930]    08C8: 58                                    pop ax
[ 931]    08C9: C3                                    ret
[ 932]        :                                       
[ 933]        :                                       
[ 934]    08CA:                                       up1y12:
[ 935]    08CA: C6 06 10 04 00                        mov dir, 00
[ 936]    08CF: B0 02                                 mov AL, 02h
[ 937]    08D1: E6 C6                                 out bsrcreg,al
[ 938]        :                                       
[ 939]    08D3: B1 00                                 mov cl, 0
[ 940]    08D5: 80 F9 01                              q11:cmp cl, 1
[ 941]    08D8: 75 FB                                 jne q11
[ 942]        :                                       
[ 943]    08DA: C6 06 0D 04 01                        mov liftMove, 01
[ 944]    08DF: E8 31 05                              call liftstar
[ 945]        :                                       
[ 946]    08E2: 59                                    pop cx
[ 947]    08E3: 5B                                    pop bx
[ 948]    08E4: 58                                    pop ax
[ 949]    08E5: C3                                    ret
[ 950]        :                                       
[ 951]        :                                       
[ 952]    08E6:                                       up1y4:
[ 953]    08E6: C6 06 11 04 00                        mov drState, 00h
[ 954]    08EB: B0 04                                 mov AL, 04h
[ 955]    08ED: E6 C6                                 out bsrcreg, AL
[ 956]        :                                       
[ 957]    08EF: 59                                    pop cx
[ 958]    08F0: 5B                                    pop bx
[ 959]    08F1: 58                                    pop ax
[ 960]    08F2: C3                                    ret
[ 961]        :                                       
[ 962]        :                                       
[ 963]    08F3:                                       up1y3:
[ 964]    08F3: 80 FC 01                              cmp ah, 01
[ 965]    08F6: 75 1D                                 jnz up1y6
[ 966]        :                                       
[ 967]    08F8: 80 FF 01                              cmp bh, 1
[ 968]    08FB: 75 11                                 jnz up1y7
[ 969]        :                                       
[ 970]        :                                       
[ 971]    08FD:                                       up1y9:
[ 972]    08FD: 8A 0E 0E 04                           mov cl, dest
[ 973]    0901: 88 0E 0F 04                           mov secdest, cl
[ 974]    0905: C6 06 0E 04 01                        mov dest, 1
[ 975]        :                                       
[ 976]    090A: 59                                    pop cx
[ 977]    090B: 5B                                    pop bx
[ 978]    090C: 58                                    pop ax
[ 979]    090D: C3                                    ret
[ 980]        :                                       
[ 981]        :                                       
[ 982]    090E:                                       up1y7:
[ 983]    090E: 80 FC 00                              cmp ah, 00
[ 984]    0911: 75 FB                                 jnz up1y7
[ 985]    0913: EB 00                                 jmp up1y6
[ 986]        :                                       
[ 987]        :                                       
[ 988]    0915:                                       up1y6:
[ 989]    0915: 3C 01                                 cmp al, 01
[ 990]    0917: 75 82                                 jnz up1y11
[ 991]        :                                       
[ 992]    0919: C6 06 11 04 00                        mov drState, 00h
[ 993]    091E: B0 04                                 mov AL, 04h
[ 994]    0920: E6 C6                                 out bsrcreg, AL
[ 995]        :                                       
[ 996]    0922: 59                                    pop cx
[ 997]    0923: 5B                                    pop bx
[ 998]    0924: 58                                    pop ax
[ 999]    0925: C3                                    ret
[1000]        :                                       up1 endp
[1001]        :                                       
[1002]        :                                       
[1003]    0926:                                       down3 proc near
[1004]    0926: 50                                    push ax
[1005]    0927: 53                                    push bx
[1006]    0928: 51                                    push cx
[1007]        :                                       
[1008]    0929: A0 12 04                              mov al, current
[1009]    092C: 8A 26 0D 04                           mov ah, liftMove
[1010]    0930: 8A 1E 11 04                           mov bl, drState
[1011]        :                                       
[1012]    0934: 3C 03                                 cmp al, 03
[1013]    0936: 75 12                                 jnz dn3y2
[1014]        :                                       
[1015]    0938: 80 FC 00                              cmp ah, 00
[1016]    093B: 75 0D                                 jnz dn3y2
[1017]        :                                       
[1018]        :                                       
[1019]    093D:                                       dn3y1:
[1020]    093D: C6 06 11 04 00                        mov drState, 00h
[1021]    0942: B0 04                                 mov AL, 04h
[1022]    0944: E6 C6                                 out bsrcreg, AL
[1023]        :                                       
[1024]    0946: 59                                    pop cx
[1025]    0947: 5B                                    pop bx
[1026]    0948: 58                                    pop ax
[1027]    0949: C3                                    ret
[1028]        :                                       
[1029]        :                                       
[1030]    094A:                                       dn3y2:
[1031]    094A: 80 FC 00                              cmp ah, 00
[1032]    094D: 75 FB                                 jnz dn3y2
[1033]        :                                       
[1034]    094F: 3C 03                                 cmp al, 03
[1035]    0951: 74 EA                                 jz dn3y1
[1036]        :                                       
[1037]    0953: C6 06 0E 04 00                        mov dest, 00
[1038]    0958: C6 06 10 04 00                        mov dir, 00
[1039]    095D: B0 02                                 mov AL, 02h
[1040]    095F: E6 C6                                 out bsrcreg,al
[1041]        :                                       
[1042]    0961: C6 06 11 04 01                        mov drState, 01h
[1043]    0966: B0 05                                 mov AL, 05h
[1044]    0968: E6 C6                                 out bsrcreg, AL
[1045]        :                                       
[1046]    096A: B1 00                                 mov cl, 0
[1047]    096C: 80 F9 01                              q12:cmp cl, 1
[1048]    096F: 75 FB                                 jne q12
[1049]        :                                       
[1050]    0971: C6 06 0D 04 01                        mov liftMove, 01
[1051]    0976: E8 9A 04                              call liftstar
[1052]        :                                       
[1053]    0979: 59                                    pop cx
[1054]    097A: 5B                                    pop bx
[1055]    097B: 58                                    pop ax
[1056]    097C: C3                                    ret
[1057]        :                                       down3 endp
[1058]        :                                       
[1059]    097D:                                       down2 proc near
[1060]    097D: 50                                    push ax
[1061]    097E: 53                                    push bx
[1062]    097F: 51                                    push cx
[1063]        :                                       
[1064]    0980: A0 12 04                              mov al, current
[1065]    0983: 8A 26 0D 04                           mov ah, liftMove
[1066]    0987: 8A 1E 11 04                           mov bl, drState
[1067]    098B: 8A 3E 10 04                           mov bh, dir
[1068]        :                                       
[1069]    098F: 3C 02                                 cmp al, 02
[1070]    0991: 75 71                                 jnz dn2y3
[1071]        :                                       
[1072]    0993: 80 FC 01                              cmp ah, 01
[1073]    0996: 75 5F                                 jnz dn2y4
[1074]        :                                       
[1075]        :                                       
[1076]    0998: 80 FC 01                              dn2y5: cmp ah, 01
[1077]    099B: 74 FB                                 jz dn2y5
[1078]        :                                       
[1079]        :                                       
[1080]    099D:                                       dn2y11:
[1081]    099D: C6 06 0E 04 01                        mov dest, 01
[1082]    09A2: C6 06 11 04 01                        mov drState, 01h
[1083]    09A7: B0 05                                 mov AL, 05h
[1084]    09A9: E6 C6                                 out bsrcreg, AL
[1085]        :                                       
[1086]    09AB: B1 00                                 mov cl, 0
[1087]    09AD: 80 F9 01                              q13:cmp cl, 1
[1088]    09B0: 75 FB                                 jne q13
[1089]        :                                       
[1090]    09B2: C6 06 0D 04 01                        mov liftMove, 01
[1091]    09B7: E8 59 04                              call liftstar
[1092]        :                                       
[1093]    09BA: 80 FC 03                              cmp ah, 03
[1094]    09BD: 75 1C                                 jnz dn2y12
[1095]        :                                       
[1096]    09BF: C6 06 10 04 00                        mov dir, 00
[1097]    09C4: B0 02                                 mov AL, 02h
[1098]    09C6: E6 C6                                 out bsrcreg,al
[1099]        :                                       
[1100]    09C8: B1 00                                 mov cl, 0
[1101]    09CA: 80 F9 01                              q14:cmp cl, 1
[1102]    09CD: 75 FB                                 jne q14
[1103]        :                                       
[1104]    09CF: C6 06 0D 04 01                        mov liftMove, 01
[1105]    09D4: E8 3C 04                              call liftstar
[1106]        :                                       
[1107]    09D7: 59                                    pop cx
[1108]    09D8: 5B                                    pop bx
[1109]    09D9: 58                                    pop ax
[1110]    09DA: C3                                    ret
[1111]        :                                       
[1112]        :                                       
[1113]    09DB:                                       dn2y12:
[1114]    09DB: C6 06 10 04 01                        mov dir, 01
[1115]    09E0: B0 03                                 mov al,03H
[1116]    09E2: E6 C6                                 out bsrcreg,al
[1117]        :                                       
[1118]    09E4: B1 00                                 mov cl, 0
[1119]    09E6: 80 F9 01                              q15:cmp cl, 1
[1120]    09E9: 75 FB                                 jne q15
[1121]        :                                       
[1122]    09EB: C6 06 0D 04 01                        mov liftMove, 01
[1123]    09F0: E8 20 04                              call liftstar
[1124]        :                                       
[1125]    09F3: 59                                    pop cx
[1126]    09F4: 5B                                    pop bx
[1127]    09F5: 58                                    pop ax
[1128]    09F6: C3                                    ret
[1129]        :                                       
[1130]        :                                       
[1131]    09F7:                                       dn2y4:
[1132]    09F7: C6 06 11 04 00                        mov drState, 00h
[1133]    09FC: B0 04                                 mov AL, 04h
[1134]    09FE: E6 C6                                 out bsrcreg, AL
[1135]        :                                       
[1136]    0A00: 59                                    pop cx
[1137]    0A01: 5B                                    pop bx
[1138]    0A02: 58                                    pop ax
[1139]    0A03: C3                                    ret
[1140]        :                                       
[1141]        :                                       
[1142]    0A04:                                       dn2y3:
[1143]    0A04: 80 FC 01                              cmp ah, 01
[1144]    0A07: 75 1D                                 jnz dn2y6
[1145]    0A09: 80 FF 01                              cmp bh, 1
[1146]    0A0C: 75 11                                 jnz dn2y7
[1147]        :                                       
[1148]        :                                       
[1149]    0A0E:                                       dn2y9:
[1150]    0A0E: 8A 0E 0E 04                           mov cl, dest
[1151]    0A12: 88 0E 0F 04                           mov secdest, cl
[1152]    0A16: C6 06 0E 04 01                        mov dest, 1
[1153]        :                                       
[1154]    0A1B: 59                                    pop cx
[1155]    0A1C: 5B                                    pop bx
[1156]    0A1D: 58                                    pop ax
[1157]    0A1E: C3                                    ret
[1158]        :                                       
[1159]        :                                       
[1160]    0A1F:                                       dn2y7:
[1161]    0A1F: 80 FC 00                              cmp ah, 00
[1162]    0A22: 75 FB                                 jnz dn2y7
[1163]    0A24: EB 00                                 jmp dn2y6
[1164]        :                                       
[1165]        :                                       
[1166]    0A26:                                       dn2y6:
[1167]    0A26: 3C 02                                 cmp al, 02
[1168]    0A28: 74 03 E9 70 FF                        jnz dn2y11
[1169]        :                                       
[1170]    0A2D: C6 06 11 04 00                        mov drState, 00h
[1171]    0A32: B0 04                                 mov AL, 04h
[1172]    0A34: E6 C6                                 out bsrcreg, AL
[1173]        :                                       
[1174]    0A36: 59                                    pop cx
[1175]    0A37: 5B                                    pop bx
[1176]    0A38: 58                                    pop ax
[1177]    0A39: C3                                    ret
[1178]        :                                       down2 endp
[1179]        :                                       
[1180]        :                                       
[1181]        :                                       ; subroutine when lift0 is pressed
[1182]    0A3A:                                       lift0 proc near
[1183]    0A3A: 50                                    push ax
[1184]    0A3B: 51                                    push cx
[1185]        :                                       
[1186]    0A3C: 80 3E 12 04 00                        cmp current, 0
[1187]    0A41: 74 2D                                 jz a1
[1188]        :                                       
[1189]    0A43: C6 06 0E 04 00                        mov dest, 0
[1190]    0A48: C6 06 10 04 00                        mov dir, 0
[1191]    0A4D: B0 02                                 mov al, 02h
[1192]    0A4F: E6 C6                                 out bsrcreg, al
[1193]        :                                       
[1194]    0A51: C6 06 11 04 01                        mov drState, 01h
[1195]    0A56: B0 05                                 mov AL, 05h
[1196]    0A58: E6 C6                                 out bsrcreg, AL
[1197]        :                                       
[1198]    0A5A: B1 00                                 mov cl, 0
[1199]    0A5C: 80 F9 01                              q16:cmp cl, 1
[1200]    0A5F: 75 FB                                 jne q16
[1201]        :                                       
[1202]    0A61: C6 06 0D 04 01                        mov liftMove, 1
[1203]    0A66: E8 AA 03                              call liftstar
[1204]        :                                       
[1205]        :                                       
[1206]        :                                       ; check if lift is moving or not
[1207]    0A69: 80 3E 0D 04 01                        a2: cmp liftMove, 1
[1208]    0A6E: 74 F9                                 jz a2
[1209]        :                                       
[1210]        :                                       
[1211]        :                                       ; secdest = 0 OR secdest = dest
[1212]    0A70: B4 00                                 a1: mov ah, 0
[1213]    0A72: A0 0F 04                              mov al, secDest
[1214]    0A75: 80 3E 0F 04 00                        cmp secDest, 0
[1215]    0A7A: 74 69                                 jz a3
[1216]        :                                       
[1217]    0A7C: FE C4                                 inc ah
[1218]    0A7E: 3A 06 0E 04                           cmp al, dest
[1219]    0A82: 74 61                                 jz a3
[1220]        :                                       
[1221]    0A84: FE C4                                 inc ah
[1222]    0A86: 80 FC 00                              cmp ah, 0
[1223]    0A89: 7D 00                                 jge a4
[1224]        :                                       
[1225]        :                                       
[1226]        :                                       ; secdest > dest
[1227]    0A8B: A0 0F 04                              a4: mov al, secDest
[1228]    0A8E: 3A 06 0E 04                           cmp al, dest
[1229]    0A92: 7F 26                                 jg a5
[1230]        :                                       
[1231]    0A94: A2 0E 04                              mov dest, al
[1232]    0A97: C6 06 10 04 00                        mov dir, 0
[1233]    0A9C: B0 02                                 mov al, 02h
[1234]    0A9E: E6 C6                                 out bsrcreg, al
[1235]        :                                       
[1236]    0AA0: C6 06 11 04 01                        mov drState, 01h
[1237]    0AA5: B0 05                                 mov AL, 05h
[1238]    0AA7: E6 C6                                 out bsrcreg, AL
[1239]        :                                       
[1240]    0AA9: B1 00                                 mov cl, 0
[1241]    0AAB: 80 F9 01                              q17:cmp cl, 1
[1242]    0AAE: 75 FB                                 jne q17
[1243]        :                                       
[1244]    0AB0: C6 06 0D 04 01                        mov liftMove, 1
[1245]    0AB5: E8 5B 03                              call liftstar
[1246]    0AB8: EB 24                                 jmp a6
[1247]        :                                       
[1248]        :                                       
[1249]    0ABA: A2 0E 04                              a5: mov dest, al
[1250]    0ABD: C6 06 10 04 01                        mov dir, 01h
[1251]    0AC2: B0 03                                 mov AL, 03h
[1252]    0AC4: E6 C6                                 out bsrcreg, AL
[1253]        :                                       
[1254]    0AC6: C6 06 11 04 01                        mov drState, 01h
[1255]    0ACB: B0 05                                 mov AL, 05h
[1256]    0ACD: E6 C6                                 out bsrcreg, AL
[1257]        :                                       
[1258]    0ACF: B1 00                                 mov cl, 0
[1259]    0AD1: 80 F9 01                              q18:cmp cl, 1
[1260]    0AD4: 75 FB                                 jne q18
[1261]        :                                       
[1262]    0AD6: C6 06 0D 04 01                        mov liftMove, 1
[1263]    0ADB: E8 35 03                              call liftstar
[1264]        :                                       
[1265]        :                                       
[1266]    0ADE: 80 3E 0D 04 01                        a6: cmp liftMove, 1
[1267]    0AE3: 74 F9                                 jz a6
[1268]        :                                       
[1269]        :                                       
[1270]    0AE5: C6 06 0E 04 00                        a3: mov dest, 0
[1271]    0AEA: C6 06 10 04 00                        mov dir, 0
[1272]    0AEF: B0 02                                 mov al, 02h
[1273]    0AF1: E6 C6                                 out bsrcreg, al
[1274]        :                                       
[1275]    0AF3: C6 06 11 04 01                        mov drState, 01h
[1276]    0AF8: B0 05                                 mov AL, 05h
[1277]    0AFA: E6 C6                                 out bsrcreg, AL
[1278]        :                                       
[1279]    0AFC: B1 00                                 mov cl, 0
[1280]    0AFE: 80 F9 01                              q19:cmp cl, 1
[1281]    0B01: 75 FB                                 jne q19
[1282]        :                                       
[1283]    0B03: C6 06 0D 04 01                        mov liftMove, 01
[1284]    0B08: E8 08 03                              call liftstar
[1285]        :                                       
[1286]    0B0B: 59                                    pop cx
[1287]    0B0C: 58                                    pop ax
[1288]    0B0D: C3                                    ret
[1289]        :                                       lift0 endp
[1290]        :                                       
[1291]        :                                       
[1292]        :                                       ; subroutine when lift1 is pressed
[1293]    0B0E:                                       lift1 proc near
[1294]    0B0E: 50                                    push ax
[1295]    0B0F: 80 3E 12 04 01                        cmp current, 1
[1296]    0B14: 74 5C                                 jz b1
[1297]        :                                       
[1298]        :                                       ; check if current floor = 0
[1299]    0B16: 80 3E 12 04 00                        cmp current, 0
[1300]    0B1B: 74 28                                 jz b2
[1301]        :                                       
[1302]    0B1D: C6 06 0E 04 01                        mov dest, 1
[1303]    0B22: C6 06 10 04 00                        mov dir, 0
[1304]    0B27: B0 02                                 mov al, 02h
[1305]    0B29: E6 C6                                 out bsrcreg, al
[1306]        :                                       
[1307]    0B2B: C6 06 11 04 01                        mov drState, 01h
[1308]    0B30: B0 05                                 mov AL, 05h
[1309]    0B32: E6 C6                                 out bsrcreg, AL
[1310]        :                                       
[1311]    0B34: B1 00                                 mov cl, 0
[1312]    0B36: 80 F9 01                              q20:cmp cl, 1
[1313]    0B39: 75 FB                                 jne q20
[1314]        :                                       
[1315]    0B3B: C6 06 0D 04 01                        mov liftMove, 01
[1316]    0B40: E8 D0 02                              call liftstar
[1317]        :                                       
[1318]    0B43: EB 26                                 jmp b3
[1319]        :                                       
[1320]        :                                       
[1321]    0B45: C6 06 0E 04 01                        b2: mov dest, 1
[1322]    0B4A: C6 06 10 04 01                        mov dir, 01h
[1323]    0B4F: B0 03                                 mov AL, 03h
[1324]    0B51: E6 C6                                 out bsrcreg, AL
[1325]        :                                       
[1326]    0B53: C6 06 11 04 01                        mov drState, 01h
[1327]    0B58: B0 05                                 mov AL, 05h
[1328]    0B5A: E6 C6                                 out bsrcreg, AL
[1329]        :                                       
[1330]    0B5C: B1 00                                 mov cl, 0
[1331]    0B5E: 80 F9 01                              q21:cmp cl, 1
[1332]    0B61: 75 FB                                 jne q21
[1333]        :                                       
[1334]    0B63: C6 06 0D 04 01                        mov liftMove, 01
[1335]    0B68: E8 A8 02                              call liftstar
[1336]        :                                       
[1337]        :                                       
[1338]        :                                       ; check if lift is moving or not
[1339]    0B6B: 80 3E 0D 04 01                        b3: cmp liftMove, 1
[1340]    0B70: 74 F9                                 jz b3
[1341]        :                                       
[1342]        :                                       
[1343]        :                                       ; secdest = 0 OR secdest = dest
[1344]    0B72: B4 00                                 b1: mov ah, 0
[1345]    0B74: A0 0F 04                              mov al, secDest
[1346]    0B77: 80 3E 0F 04 00                        cmp secDest, 0
[1347]    0B7C: 74 69                                 jz b4
[1348]        :                                       
[1349]    0B7E: FE C4                                 inc ah
[1350]    0B80: 3A 06 0E 04                           cmp al, dest
[1351]    0B84: 74 61                                 jz b4
[1352]        :                                       
[1353]    0B86: FE C4                                 inc ah
[1354]    0B88: 80 FC 00                              cmp ah, 0
[1355]    0B8B: 7D 00                                 jge b5
[1356]        :                                       
[1357]        :                                       
[1358]        :                                       ; secdest > dest
[1359]    0B8D: A0 0F 04                              b5: mov al, secDest
[1360]    0B90: 3A 06 0E 04                           cmp al, dest
[1361]    0B94: 7F 26                                 jg b6
[1362]        :                                       
[1363]    0B96: A2 0E 04                              mov dest, al
[1364]    0B99: C6 06 10 04 00                        mov dir, 0
[1365]    0B9E: B0 02                                 mov al, 02h
[1366]    0BA0: E6 C6                                 out bsrcreg, al
[1367]        :                                       
[1368]    0BA2: C6 06 11 04 01                        mov drState, 01h
[1369]    0BA7: B0 05                                 mov AL, 05h
[1370]    0BA9: E6 C6                                 out bsrcreg, AL
[1371]        :                                       
[1372]    0BAB: B1 00                                 mov cl, 0
[1373]    0BAD: 80 F9 01                              q22:cmp cl, 1
[1374]    0BB0: 75 FB                                 jne q22
[1375]        :                                       
[1376]    0BB2: C6 06 0D 04 01                        mov liftMove, 01
[1377]    0BB7: E8 59 02                              call liftstar
[1378]        :                                       
[1379]    0BBA: EB 24                                 jmp b7
[1380]        :                                       
[1381]        :                                       
[1382]    0BBC: A2 0E 04                              b6: mov dest, al
[1383]    0BBF: C6 06 10 04 01                        mov dir, 01h
[1384]    0BC4: B0 03                                 mov AL, 03h
[1385]    0BC6: E6 C6                                 out bsrcreg, AL
[1386]        :                                       
[1387]    0BC8: C6 06 11 04 01                        mov drState, 01h
[1388]    0BCD: B0 05                                 mov AL, 05h
[1389]    0BCF: E6 C6                                 out bsrcreg, AL
[1390]        :                                       
[1391]    0BD1: B1 00                                 mov cl, 0
[1392]    0BD3: 80 F9 01                              q23:cmp cl, 1
[1393]    0BD6: 75 FB                                 jne q23
[1394]        :                                       
[1395]    0BD8: C6 06 0D 04 01                        mov liftMove, 01
[1396]    0BDD: E8 33 02                              call liftstar
[1397]        :                                       
[1398]        :                                       
[1399]    0BE0: 80 3E 0D 04 01                        b7: cmp liftMove, 1
[1400]    0BE5: 74 F9                                 jz b7
[1401]        :                                       
[1402]        :                                       
[1403]    0BE7: C6 06 0E 04 00                        b4: mov dest, 0
[1404]    0BEC: C6 06 10 04 00                        mov dir, 0
[1405]    0BF1: B0 02                                 mov al, 02h
[1406]    0BF3: E6 C6                                 out bsrcreg, al
[1407]        :                                       
[1408]    0BF5: C6 06 11 04 01                        mov drState, 01h
[1409]    0BFA: B0 05                                 mov AL, 05h
[1410]    0BFC: E6 C6                                 out bsrcreg, AL
[1411]        :                                       
[1412]    0BFE: B1 00                                 mov cl, 0
[1413]    0C00: 80 F9 01                              q24:cmp cl, 1
[1414]    0C03: 75 FB                                 jne q24
[1415]        :                                       
[1416]    0C05: C6 06 0D 04 01                        mov liftMove, 01
[1417]    0C0A: E8 06 02                              call liftstar
[1418]        :                                       
[1419]    0C0D: 59                                    pop cx
[1420]    0C0E: 58                                    pop ax
[1421]    0C0F: C3                                    ret
[1422]        :                                       lift1 endp
[1423]        :                                       
[1424]        :                                       
[1425]        :                                       ; subroutine when lift2 is pressed
[1426]    0C10:                                       lift2 proc near
[1427]    0C10: 50                                    push ax
[1428]    0C11: 51                                    push cx
[1429]        :                                       
[1430]    0C12: 80 3E 12 04 02                        cmp current, 2
[1431]    0C17: 74 5C                                 jz c1
[1432]        :                                       
[1433]        :                                       ; check if current floor = 3
[1434]    0C19: 80 3E 12 04 03                        cmp current, 3
[1435]    0C1E: 74 28                                 jz c2
[1436]        :                                       
[1437]    0C20: C6 06 0E 04 02                        mov dest, 2
[1438]    0C25: C6 06 10 04 01                        mov dir, 01h
[1439]    0C2A: B0 03                                 mov AL, 03h
[1440]    0C2C: E6 C6                                 out bsrcreg, AL
[1441]        :                                       
[1442]    0C2E: C6 06 11 04 01                        mov drState, 01h
[1443]    0C33: B0 05                                 mov AL, 05h
[1444]    0C35: E6 C6                                 out bsrcreg, AL
[1445]        :                                       
[1446]    0C37: B1 00                                 mov cl, 0
[1447]    0C39: 80 F9 01                              q25:cmp cl, 1
[1448]    0C3C: 75 FB                                 jne q25
[1449]        :                                       
[1450]    0C3E: C6 06 0D 04 01                        mov liftMove, 01
[1451]    0C43: E8 CD 01                              call liftstar
[1452]        :                                       
[1453]    0C46: EB 26                                 jmp c3
[1454]        :                                       
[1455]        :                                       
[1456]    0C48: C6 06 0E 04 02                        c2: mov dest, 2
[1457]    0C4D: C6 06 10 04 00                        mov dir, 0
[1458]    0C52: B0 02                                 mov al, 02h
[1459]    0C54: E6 C6                                 out bsrcreg, al
[1460]        :                                       
[1461]    0C56: C6 06 11 04 01                        mov drState, 01h
[1462]    0C5B: B0 05                                 mov AL, 05h
[1463]    0C5D: E6 C6                                 out bsrcreg, AL
[1464]        :                                       
[1465]    0C5F: B1 00                                 mov cl, 0
[1466]    0C61: 80 F9 01                              q26:cmp cl, 1
[1467]    0C64: 75 FB                                 jne q26
[1468]        :                                       
[1469]    0C66: C6 06 0D 04 01                        mov liftMove, 01
[1470]    0C6B: E8 A5 01                              call liftstar
[1471]        :                                       
[1472]        :                                       
[1473]        :                                       ; check if lift is moving or not
[1474]    0C6E: 80 3E 0D 04 01                        c3: cmp liftMove, 1
[1475]    0C73: 74 F9                                 jz c3
[1476]        :                                       
[1477]        :                                       
[1478]        :                                       ; secdest = 0 OR secdest = dest
[1479]    0C75: B4 00                                 c1: mov ah, 0
[1480]    0C77: A0 0F 04                              mov al, secDest
[1481]    0C7A: 80 3E 0F 04 00                        cmp secDest, 0
[1482]    0C7F: 74 69                                 jz c4
[1483]        :                                       
[1484]    0C81: FE C4                                 inc ah
[1485]    0C83: 3A 06 0E 04                           cmp al, dest
[1486]    0C87: 74 61                                 jz c4
[1487]        :                                       
[1488]    0C89: FE C4                                 inc ah
[1489]    0C8B: 80 FC 00                              cmp ah, 0
[1490]    0C8E: 7D 00                                 jge c5
[1491]        :                                       
[1492]        :                                       
[1493]        :                                       ; secdest > dest
[1494]    0C90: A0 0F 04                              c5: mov al, secDest
[1495]    0C93: 3A 06 0E 04                           cmp al, dest
[1496]    0C97: 7F 26                                 jg c6
[1497]        :                                       
[1498]    0C99: A2 0E 04                              mov dest, al
[1499]    0C9C: C6 06 10 04 00                        mov dir, 0
[1500]    0CA1: B0 02                                 mov al, 02h
[1501]    0CA3: E6 C6                                 out bsrcreg, al
[1502]        :                                       
[1503]    0CA5: C6 06 11 04 01                        mov drState, 01h
[1504]    0CAA: B0 05                                 mov AL, 05h
[1505]    0CAC: E6 C6                                 out bsrcreg, AL
[1506]        :                                       
[1507]    0CAE: B1 00                                 mov cl, 0
[1508]    0CB0: 80 F9 01                              q27:cmp cl, 1
[1509]    0CB3: 75 FB                                 jne q27
[1510]        :                                       
[1511]    0CB5: C6 06 0D 04 01                        mov liftMove, 01
[1512]    0CBA: E8 56 01                              call liftstar
[1513]        :                                       
[1514]    0CBD: EB 24                                 jmp c7
[1515]        :                                       
[1516]        :                                       
[1517]    0CBF: A2 0E 04                              c6: mov dest, al
[1518]    0CC2: C6 06 10 04 01                        mov dir, 01h
[1519]    0CC7: B0 03                                 mov AL, 03h
[1520]    0CC9: E6 C6                                 out bsrcreg, AL
[1521]        :                                       
[1522]    0CCB: C6 06 11 04 01                        mov drState, 01h
[1523]    0CD0: B0 05                                 mov AL, 05h
[1524]    0CD2: E6 C6                                 out bsrcreg, AL
[1525]        :                                       
[1526]    0CD4: B1 00                                 mov cl, 0
[1527]    0CD6: 80 F9 01                              q28:cmp cl, 1
[1528]    0CD9: 75 FB                                 jne q28
[1529]        :                                       
[1530]    0CDB: C6 06 0D 04 01                        mov liftMove, 01
[1531]    0CE0: E8 30 01                              call liftstar
[1532]        :                                       
[1533]        :                                       
[1534]    0CE3: 80 3E 0D 04 01                        c7: cmp liftMove, 1
[1535]    0CE8: 74 F9                                 jz c7
[1536]        :                                       
[1537]        :                                       
[1538]    0CEA: C6 06 0E 04 00                        c4: mov dest, 0
[1539]    0CEF: C6 06 10 04 00                        mov dir, 0
[1540]    0CF4: B0 02                                 mov al, 02h
[1541]    0CF6: E6 C6                                 out bsrcreg, al
[1542]        :                                       
[1543]    0CF8: C6 06 11 04 01                        mov drState, 01h
[1544]    0CFD: B0 05                                 mov AL, 05h
[1545]    0CFF: E6 C6                                 out bsrcreg, AL
[1546]        :                                       
[1547]    0D01: B1 00                                 mov cl, 0
[1548]    0D03: 80 F9 01                              q29:cmp cl, 1
[1549]    0D06: 75 FB                                 jne q29
[1550]        :                                       
[1551]    0D08: C6 06 0D 04 01                        mov liftMove, 01
[1552]    0D0D: E8 03 01                              call liftstar
[1553]        :                                       
[1554]    0D10: 59                                    pop cx
[1555]    0D11: 58                                    pop ax
[1556]    0D12: C3                                    ret
[1557]        :                                       lift2 endp
[1558]        :                                       
[1559]        :                                       
[1560]        :                                       ; subroutine when lift3 is pressed
[1561]    0D13:                                       lift3 proc near
[1562]    0D13: 50                                    push ax
[1563]    0D14: 51                                    push cx
[1564]        :                                       
[1565]    0D15: 80 3E 12 04 03                        cmp current, 3
[1566]    0D1A: 74 2D                                 jz d1
[1567]        :                                       
[1568]    0D1C: C6 06 0E 04 03                        mov dest, 3
[1569]    0D21: C6 06 10 04 01                        mov dir, 01h
[1570]    0D26: B0 03                                 mov AL, 03h
[1571]    0D28: E6 C6                                 out bsrcreg, AL
[1572]        :                                       
[1573]    0D2A: C6 06 11 04 01                        mov drState, 01h
[1574]    0D2F: B0 05                                 mov AL, 05h
[1575]    0D31: E6 C6                                 out bsrcreg, AL
[1576]        :                                       
[1577]    0D33: B1 00                                 mov cl, 0
[1578]    0D35: 80 F9 01                              q30:cmp cl, 1
[1579]    0D38: 75 FB                                 jne q30
[1580]        :                                       
[1581]    0D3A: C6 06 0D 04 01                        mov liftMove, 01
[1582]    0D3F: E8 D1 00                              call liftstar
[1583]        :                                       
[1584]        :                                       
[1585]        :                                       ; check if lift is moving or not
[1586]    0D42: 80 3E 0D 04 01                        d2: cmp liftMove, 1
[1587]    0D47: 74 F9                                 jz d2
[1588]        :                                       
[1589]        :                                       
[1590]        :                                       ; secdest = 0 OR secdest = dest
[1591]    0D49: B4 00                                 d1: mov ah, 0
[1592]    0D4B: A0 0F 04                              mov al, secDest
[1593]    0D4E: 80 3E 0F 04 00                        cmp secDest, 0
[1594]    0D53: 74 69                                 jz d3
[1595]        :                                       
[1596]    0D55: FE C4                                 inc ah
[1597]    0D57: 3A 06 0E 04                           cmp al, dest
[1598]    0D5B: 74 61                                 jz d3
[1599]        :                                       
[1600]    0D5D: FE C4                                 inc ah
[1601]    0D5F: 80 FC 00                              cmp ah, 0
[1602]    0D62: 7D 00                                 jge d4
[1603]        :                                       
[1604]        :                                       
[1605]        :                                       ; secdest > dest
[1606]    0D64: A0 0F 04                              d4: mov al, secDest
[1607]    0D67: 3A 06 0E 04                           cmp al, dest
[1608]    0D6B: 7F 26                                 jg d5
[1609]        :                                       
[1610]    0D6D: A2 0E 04                              mov dest, al
[1611]    0D70: C6 06 10 04 00                        mov dir, 0
[1612]    0D75: B0 02                                 mov al, 02h
[1613]    0D77: E6 C6                                 out bsrcreg, al
[1614]        :                                       
[1615]    0D79: C6 06 11 04 01                        mov drState, 01h
[1616]    0D7E: B0 05                                 mov AL, 05h
[1617]    0D80: E6 C6                                 out bsrcreg, AL
[1618]        :                                       
[1619]    0D82: B1 00                                 mov cl, 0
[1620]    0D84: 80 F9 01                              q31:cmp cl, 1
[1621]    0D87: 75 FB                                 jne q31
[1622]        :                                       
[1623]    0D89: C6 06 0D 04 01                        mov liftMove, 01
[1624]    0D8E: E8 82 00                              call liftstar
[1625]        :                                       
[1626]    0D91: EB 24                                 jmp d6
[1627]        :                                       
[1628]        :                                       
[1629]    0D93: A2 0E 04                              d5: mov dest, al
[1630]    0D96: C6 06 10 04 01                        mov dir, 01h
[1631]    0D9B: B0 03                                 mov AL, 03h
[1632]    0D9D: E6 C6                                 out bsrcreg, AL
[1633]        :                                       
[1634]    0D9F: C6 06 11 04 01                        mov drState, 01h
[1635]    0DA4: B0 05                                 mov AL, 05h
[1636]    0DA6: E6 C6                                 out bsrcreg, AL
[1637]        :                                       
[1638]    0DA8: B1 00                                 mov cl, 0
[1639]    0DAA: 80 F9 01                              q32:cmp cl, 1
[1640]    0DAD: 75 FB                                 jne q32
[1641]        :                                       
[1642]    0DAF: C6 06 0D 04 01                        mov liftMove, 01
[1643]    0DB4: E8 5C 00                              call liftstar
[1644]        :                                       
[1645]        :                                       
[1646]    0DB7: 80 3E 0D 04 01                        d6: cmp liftMove, 1
[1647]    0DBC: 74 F9                                 jz d6
[1648]        :                                       
[1649]        :                                       
[1650]    0DBE: C6 06 0E 04 00                        d3: mov dest, 0
[1651]    0DC3: C6 06 10 04 00                        mov dir, 0
[1652]    0DC8: B0 02                                 mov al, 02h
[1653]    0DCA: E6 C6                                 out bsrcreg, al
[1654]        :                                       
[1655]    0DCC: C6 06 11 04 01                        mov drState, 01h
[1656]    0DD1: B0 05                                 mov AL, 05h
[1657]    0DD3: E6 C6                                 out bsrcreg, AL
[1658]        :                                       
[1659]    0DD5: B1 00                                 mov cl, 0
[1660]    0DD7: 80 F9 01                              q33:cmp cl, 1
[1661]    0DDA: 75 FB                                 jne q33
[1662]        :                                       
[1663]    0DDC: C6 06 0D 04 01                        mov liftMove, 01
[1664]    0DE1: E8 2F 00                              call liftstar
[1665]        :                                       
[1666]    0DE4: 59                                    pop cx
[1667]    0DE5: 58                                    pop ax
[1668]    0DE6: C3                                    ret
[1669]        :                                       lift3 endp
[1670]        :                                       
[1671]        :                                       
[1672]        :                                       ; subroutine when drClose is called
[1673]    0DE7:                                       drClose proc near
[1674]    0DE7: 50                                    push ax
[1675]        :                                       
[1676]    0DE8: C6 06 11 04 01                        mov drState, 01h
[1677]    0DED: B0 05                                 mov AL, 05h
[1678]    0DEF: E6 C6                                 out bsrcreg, AL
[1679]        :                                       
[1680]    0DF1: 58                                    pop ax
[1681]    0DF2: C3                                    ret
[1682]        :                                       drClose endp
[1683]        :                                       
[1684]        :                                       
[1685]        :                                       ; LED display logic
[1686]    0DF3:                                       ledDisp proc near
[1687]    0DF3: 50                                    push ax
[1688]        :                                       
[1689]    0DF4: A0 12 04                              mov al, current
[1690]    0DF7: E6 B0                                 out porta, al
[1691]        :                                       
[1692]    0DF9: 80 3E 0D 04 01                        cmp liftMove, 01
[1693]    0DFE: 75 02                                 jnz e1
[1694]        :                                       
[1695]    0E00: E6 B2                                 out portb, al
[1696]        :                                       
[1697]        :                                       
[1698]    0E02: 80 3E 10 04 00                        e1: cmp dir, 00
[1699]    0E07: 75 04                                 jnz e2
[1700]        :                                       
[1701]    0E09: FE C8                                 dec al
[1702]    0E0B: E6 B2                                 out portb, al
[1703]        :                                       
[1704]        :                                       
[1705]    0E0D: FE C0                                 e2: inc al
[1706]    0E0F: E6 B2                                 out portb, al
[1707]        :                                       
[1708]    0E11: 58                                    pop ax
[1709]    0E12: C3                                    ret
[1710]        :                                       ledDisp endp
[1711]        :                                       
[1712]        :                                       
[1713]        :                                       ; start and accelaration routine 0% to 40%
[1714]    0E13:                                       liftstar proc near
[1715]    0E13: 50                                    push ax
[1716]    0E14: 51                                    push cx
[1717]        :                                       
[1718]    0E15: B0 08                                 mov AL,08h ; for 20% duty cycle
[1719]    0E17: E6 84                                 out pwm,AL
[1720]        :                                       
[1721]    0E19: B0 00                                 mov AL,00h ; first give a low on port PC0 (bsr) (0000 000 0b)
[1722]    0E1B: E6 C6                                 out bsrcreg,AL
[1723]        :                                       
[1724]    0E1D: B0 01                                 mov AL,01h ; then give a high on port PC0 (bsr) to trigger one shot timer (0000 000 1b)
[1725]    0E1F: E6 C6                                 out bsrcreg,AL
[1726]        :                                       
[1727]    0E21: B1 00                                 mov CL,00h
[1728]    0E23: 80 F9 01                              il1:cmp CL,01h ; infinite loop, waiting for ISR to set CL to 1
[1729]    0E26: 75 FB                                 jne il1
[1730]        :                                       
[1731]    0E28: B0 07                                 mov AL,07h ; 30% duty cycle
[1732]    0E2A: E6 84                                 out pwm,AL
[1733]        :                                       
[1734]    0E2C: B0 00                                 mov AL,00h
[1735]    0E2E: E6 C6                                 out bsrcreg,AL
[1736]        :                                       
[1737]    0E30: B0 01                                 mov AL,01h
[1738]    0E32: E6 C6                                 out bsrcreg,AL
[1739]        :                                       
[1740]    0E34: B1 00                                 mov CL,00h
[1741]    0E36: 80 F9 01                              il2:cmp CL,01h ; infinite loop, waiting for ISR to set CL to 1
[1742]    0E39: 75 FB                                 jne il2
[1743]        :                                       
[1744]    0E3B: B0 06                                 mov AL,06h ; 40% duty cycle
[1745]    0E3D: E6 84                                 out pwm, AL
[1746]        :                                       
[1747]    0E3F: 59                                    pop cx
[1748]    0E40: 58                                    pop ax
[1749]    0E41: C3                                    ret
[1750]        :                                       liftstar endp
[1751]        :                                       
[1752]        :                                       
[1753]        :                                       ; accelaration to 50%
[1754]    0E42:                                       accel50 proc near
[1755]    0E42: 50                                    push ax
[1756]        :                                       
[1757]    0E43: B0 05                                 mov AL,05h ; 50% duty cycle
[1758]    0E45: E6 84                                 out pwm, AL
[1759]        :                                       
[1760]    0E47: 58                                    pop ax
[1761]    0E48: C3                                    ret
[1762]        :                                       accel50 endp
[1763]        :                                       
[1764]        :                                       
[1765]        :                                       ; decelaration routine from 50% to 20%
[1766]    0E49:                                       decel20 proc near
[1767]    0E49: 50                                    push ax
[1768]    0E4A: 51                                    push cx
[1769]        :                                       
[1770]    0E4B: B0 06                                 mov AL,06h ; 40%
[1771]    0E4D: E6 84                                 out pwm,AL
[1772]        :                                       
[1773]    0E4F: B0 00                                 mov AL,00h
[1774]    0E51: E6 C6                                 out bsrcreg,AL
[1775]        :                                       
[1776]    0E53: B0 01                                 mov AL,01h
[1777]    0E55: E6 C6                                 out bsrcreg,AL
[1778]        :                                       
[1779]    0E57: B1 00                                 mov CL,00h
[1780]    0E59: 80 F9 01                              il3:cmp CL,01h
[1781]    0E5C: 75 FB                                 jne il3
[1782]        :                                       
[1783]    0E5E: B0 07                                 mov AL,07h ; 30%
[1784]    0E60: E6 84                                 out pwm,AL
[1785]        :                                       
[1786]    0E62: B0 00                                 mov AL,00h
[1787]    0E64: E6 C6                                 out bsrcreg,AL
[1788]        :                                       
[1789]    0E66: B0 01                                 mov AL,01h
[1790]    0E68: E6 C6                                 out bsrcreg,AL
[1791]        :                                       
[1792]    0E6A: B1 00                                 mov CL,00h
[1793]    0E6C: 80 F9 01                              il4:cmp CL,01h
[1794]    0E6F: 75 FB                                 jne il4
[1795]        :                                       
[1796]    0E71: B0 08                                 mov AL,08h ; 20%
[1797]    0E73: E6 84                                 out pwm,AL
[1798]        :                                       
[1799]    0E75: 59                                    pop cx
[1800]    0E76: 58                                    pop ax
[1801]    0E77: C3                                    ret
[1802]        :                                       decel20 endp
[1803]        :                                       
[1804]        :                                       ; finally stop from 20% to 0
[1805]    0E78:                                       liftstop proc near
[1806]    0E78: 50                                    push ax
[1807]        :                                       
[1808]    0E79: B0 0A                                 mov AL,0ah
[1809]    0E7B: E6 84                                 out pwm,AL
[1810]        :                                       
[1811]    0E7D: 58                                    pop ax
[1812]    0E7E: C3                                    ret
[1813]        :                                       liftstop endp
[1814]        :                                       
[1815]        :                                       
[1816]        :                                       
[1817]        :                                       		
[1818]        :                                       	
[1819]        :                                       
[1820]        :                                       
[1821]        :                                       		
[1822]        :                                       
[1823]        :                                       
[1824]        :                                       
[1825]        :                                       
[1826]        :                                       
[1827]        :                                       
[1828]        :                                       
[1829]        :                                       
[1830]        :                                       
[1831]        :                                       
[1832]        :                                       
[1833]        :                                       
[1834]        :                                       
[1835]        :                                       
 
===================================================================================================
 




===================================================================================================
